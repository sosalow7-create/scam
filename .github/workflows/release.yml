name: Create Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    name: Create Release
    runs-on: macos-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Setup Xcode
      uses: maxim-lobanov/setup-xcode@v1
      with:
        xcode-version: latest-stable
    
    - name: Build for Release
      run: |
        xcodebuild clean archive \
          -project SCAM.xcodeproj \
          -scheme SCAM \
          -archivePath build/SCAM.xcarchive \
          -sdk iphonesimulator \
          CODE_SIGNING_ALLOWED=NO
    
    - name: Create Release
      uses: softprops/action-gh-release@v1
      with:
        files: |
          README.md
          CHANGELOG.md
        body: |
          ## SCAM Messenger Release ${{ github.ref_name }}
          
          ### What's New
          Check [CHANGELOG.md](CHANGELOG.md) for details.
          
          ### Installation
          See [INSTALLATION.md](INSTALLATION.md) for setup instructions.
          
          ### Documentation
          - [Quick Start Guide](QUICKSTART.md)
          - [Development Guide](DEVELOPMENT.md)
          - [Features List](FEATURES.md)
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
